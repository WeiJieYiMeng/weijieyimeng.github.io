<meta charset="UTF-8" />
<button onclick="dstr()">待生成完后再下载</button><hr/>
<p style="white-space: pre-wrap;">menu=[</p>
<script>
  function urlrel(release){let params=new URLSearchParams(window.location.href.split('?')[1]);return params.get(release);}
  const bookname=urlrel("b");
  const p=document.querySelector("p")
  function getTitle(num){
    fetch("/"+bookname+"/"+num+".txt")
      .then(response => {
        if (!response.ok) {
          p.innerHTML=p.innerHTML.slice(0, -2)+"\n]";throw new Error();
        }
        return response.text();
      })
      .then(text => {
        let tl=text.split("\n")[0].replace("\r","").replace("\n","");
        console.log(tl);
        p.innerHTML+="\""+tl+"\",\n";
        getTitle(num+1);
      })
  }
  try{getTitle(0)}catch{};
    
  function dstr() {
    const blob = new Blob([p.innerHTML], {type: 'text/plain'});
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = "menu.js";
    a.style.display = 'none';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
  }
</script>

